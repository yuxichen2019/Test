<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
    <title>地图</title>
    <link rel="stylesheet" href="https://a.amap.com/jsapi_demos/static/demo-center/css/demo-center.css"/>
    <style>
        html, body, #container {
            height: 100%;
            width: 100%;
        }

        .content-window-card {
            position: relative;
            box-shadow: none;
            bottom: 0;
            left: 0;
            width: auto;
            padding: 0;
        }

        .content-window-card p {
            height: 2rem;
        }

        .custom-info {
            border: solid 1px silver;
        }

        div.info-top {
            position: relative;
            background: none repeat scroll 0 0 #F9F9F9;
            border-bottom: 1px solid #CCC;
            border-radius: 5px 5px 0 0;
        }

        div.info-top div {
            display: inline-block;
            color: #333333;
            font-size: 14px;
            font-weight: bold;
            line-height: 31px;
            padding: 0 10px;
        }

        div.info-top img {
            position: absolute;
            top: 10px;
            right: 10px;
            transition-duration: 0.25s;
        }

        div.info-top img:hover {
            box-shadow: 0px 0px 5px #000;
        }

        div.info-middle {
            font-size: 12px;
            padding: 10px 6px;
            line-height: 20px;
        }

        div.info-bottom {
            height: 0px;
            width: 100%;
            clear: both;
            text-align: center;
        }

        div.info-bottom img {
            position: relative;
            z-index: 104;
        }

        span {
            margin-left: 5px;
            font-size: 11px;
        }

        .info-middle img {
            float: left;
            margin-right: 6px;
        }
        
        .block-no-results{
        	display:none;
        	position: fixed;
        	left:0;
        	top: 0;
        	right: 0;
        	bottom: 0;
        	font-size: 20px;
        }
    </style>
</head>
<body>
<div id="container"></div>


<div class="block-no-results" p-id="1308" style="padding-top:40px;text-align:center;">,<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="170px" height="170px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve" p-id="1309"><g p-id="1310">,<path fill="#EEEEEE" d="M18.224,35.559c0,0,0.38-0.042,0.592,0.211s0.465,3.804,1.395,4.776s4.692,0.423,4.692,1.691c0,1.014-3.496,1.124-4.68,2.096c-1.184,0.972-0.507,5.072-1.957,4.921c-1.135-0.119-0.338-3.381-1.733-4.692s-4.776-1.057-4.776-2.24s3.466-0.465,4.65-1.818C17.59,39.152,17.083,35.559,18.224,35.559z" p-id="1311">,</path>,<path fill="#B1AFAE" d="M7.726,77.11c0,0,0.23-0.026,0.357,0.128c0.128,0.153,0.281,2.296,0.842,2.883s2.832,0.255,2.832,1.02c0,0.612-2.11,0.678-2.824,1.265c-0.714,0.587-0.306,3.061-1.181,2.97c-0.685-0.072-0.204-2.041-1.046-2.832c-0.842-0.791-2.883-0.638-2.883-1.352s2.092-0.281,2.806-1.097C7.343,79.279,7.037,77.11,7.726,77.11z" p-id="1312">,</path>,<path fill="#EEEEEE" d="M190.447,56.933c0,0,0.261-0.029,0.406,0.145s0.319,2.608,0.956,3.274c0.637,0.666,3.216,0.29,3.216,1.159c0,0.695-2.396,0.77-3.208,1.437c-0.811,0.666-0.348,3.477-1.341,3.373c-0.778-0.081-0.232-2.318-1.188-3.216c-0.956-0.898-3.274-0.724-3.274-1.536s2.376-0.319,3.187-1.246C190.013,59.396,189.665,56.933,190.447,56.933z" p-id="1313">,</path>,<path fill="#B1AFAE" d="M154.66,25.617c0,0,0.261-0.029,0.406,0.145c0.145,0.174,0.319,2.608,0.956,3.274c0.637,0.666,3.216,0.29,3.216,1.159c0,0.695-2.396,0.77-3.208,1.437c-0.811,0.666-0.348,3.477-1.341,3.373c-0.778-0.081-0.232-2.318-1.188-3.216c-0.956-0.898-3.274-0.724-3.274-1.536s2.376-0.319,3.187-1.246C154.226,28.08,153.878,25.617,154.66,25.617z" p-id="1314">,</path>,<circle fill="#EEEEEE" cx="56.234" cy="19.989" r="3.79" p-id="1315"></circle><circle fill="#EEEEEE" cx="178.362" cy="75.509" r="2.376" p-id="1316"></circle></g><circle fill="#EEEEEE" cx="95.662" cy="104.843" r="77.333" p-id="1317"></circle>,<path fill="#FDFDFD" d="M145.856,131.98c-0.023,3.196-2.633,5.769-5.829,5.746l-89.136-0.146c-3.196-0.023-5.769-2.633-5.746-5.829l0.431-56.782c0.023-3.196,2.633-5.769,5.829-5.746l72.81,0.029c5.893,5.294,13.625,12.765,21.971,19.869L145.856,131.98z" p-id="1318" data-spm-anchor-id="a313x.7781069.1998910419.i1"></path><path fill="#D8D8D8" d="M146.469,87.616c-0.026,1.112-0.949,1.992-2.061,1.966l-19.059-0.448c-1.112-0.026-1.992-0.949-1.966-2.061l0.381-16.217c0.026-1.112,0.949-1.992,2.061-1.966L146.469,87.616z" p-id="1319">,</path>,<circle fill="#EEEEEE" cx="117.299" cy="128.428" r="18.247" p-id="1320"></circle>,<path fill="#FFFFFF" d="M117.412,148.245c2.241,0,4.352-0.653,6.209-1.801l-0.006-2.304c0,0-0.31-3.921-3.169-4.83c-0.044-0.014-0.76,0.77-2.055,0.699l-0.831-0.262c-0.085,0.004-0.178,0.127-0.262,0.131c-0.085-0.004-0.395-0.433-0.481-0.437l-0.437,0.219c-1.294,0.071-2.054-0.403-2.098-0.389c-2.859,0.909-3.073,4.869-3.073,4.869l-0.006,2.304C113.06,147.592,115.171,148.245,117.412,148.245z" p-id="1321">,</path>,<path fill="#FFFFFF" d="M126.565,131.668c-0.091-4.974-4.313-8.929-9.431-8.836c-5.117,0.094-9.192,4.202-9.1,9.175c0.059,3.23,1.95,6.365,4.669,8.141l9.773-0.179c2.294-1.693,3.83-4.47,4.06-7.374C126.561,132.288,126.57,131.978,126.565,131.668zM121.961,139.026l-9.001,0.165c-2.103-1.47-3.536-3.873-3.581-6.347c-0.074-4.03,3.384-7.361,7.723-7.441c4.339-0.08,7.917,3.123,7.991,7.153C125.137,135.032,123.914,137.482,121.961,139.026z" p-id="1322">,</path>,<path fill="#B1AFAE" d="M113.09,139.511l8.674-0.159c1.881-1.543,3.058-3.992,3.013-6.467c-0.074-4.029-3.523-7.233-7.705-7.157c-4.181,0.077-7.511,3.405-7.437,7.434C109.68,135.636,111.063,138.04,113.09,139.511z" p-id="1323">,</path>,<linearGradient id="SVGID_1_" gradientUnits="userSpaceOnUse" x1="213.0032" y1="105.5631" x2="213.0032" y2="105.5631" gradientTransform="matrix(0.9989 0.0478 -0.0478 0.9989 -99.1255 22.5725)" p-id="1324"><stop offset="0.2225" style="stop-color:#FFFFFF" p-id="1325"></stop><stop offset="1" style="stop-color:#D1D3D4" p-id="1326"></stop></linearGradient>,<path fill="url(#SVGID_1_)" d="M108.588,138.199" p-id="1327"></path><path fill="#B1AFAE" d="M122.101,140.456c-1.196,0.936-3.021,0.947-4.737,0.969c-1.752,0.023-3.397,0.04-4.644-0.756c-0.398-0.254-0.581-0.843-0.41-0.847l10.184-0.231C122.665,139.587,122.402,140.221,122.101,140.456z" p-id="1328"></path><path fill="#C8C7C6" d="M109.59,133.167c-0.074-4.049,3.268-7.393,7.465-7.47c4.197-0.077,7.659,3.143,7.734,7.191c0.03,1.624-0.464,3.237-1.336,4.592c1.06-1.425,1.672-3.18,1.639-4.947c-0.074-4.049-3.665-7.267-8.02-7.187c-4.355,0.08-7.826,3.427-7.752,7.477c0.027,1.493,0.558,2.96,1.434,4.214C110.041,135.862,109.615,134.525,109.59,133.167z" p-id="1329">,</path>,<path fill="#FFFFFF" d="M122.199,140.266c-1.218,0.535-3.07,0.508-4.805,0.538c-1.771,0.031-3.424,0.109-4.676-0.323c-0.399-0.138-0.578-0.465-0.406-0.469l10.293-0.234C122.778,139.775,122.506,140.132,122.199,140.266z" p-id="1330">,</path>,<linearGradient id="SVGID_2_" gradientUnits="userSpaceOnUse" x1="221.3779" y1="106.4216" x2="221.3779" y2="106.4216" gradientTransform="matrix(0.9989 0.0478 -0.0478 0.9989 -99.1255 22.5725)" p-id="1331"><stop offset="0.2225" style="stop-color:#FFFFFF" p-id="1332"></stop><stop offset="1" style="stop-color:#D1D3D4" p-id="1333"></stop></linearGradient>,<path fill="url(#SVGID_2_)" d="M116.912,139.457" p-id="1334"></path><path fill="#C1C1C1" d="M122.63,139.791c0,0.241-0.196,0.437-0.437,0.437h-9.617c-0.241,0-0.437-0.196-0.437-0.437l0,0c0-0.241,0.196-0.437,0.437-0.437h9.617C122.434,139.354,122.63,139.549,122.63,139.791L122.63,139.791z" p-id="1335">,</path>,<path fill="#B1AFAE" d="M119.922,145.551c0,0.108-0.088,0.196-0.196,0.196l-4.626,0.003c-0.108,0-0.196-0.088-0.196-0.196l-0.002-3.131c0-0.108,0.088-0.196,0.196-0.196l4.626-0.003c0.108,0,0.196,0.088,0.196,0.196L119.922,145.551z" p-id="1336">,</path>,<path fill="#CCCCCC" d="M119.374,145.166c0,0.082-0.069,0.148-0.153,0.148l-3.616,0.002c-0.085,0-0.154-0.066-0.154-0.148l-0.001-2.36c0-0.082,0.069-0.148,0.153-0.148l3.616-0.002c0.085,0,0.154,0.066,0.154,0.148L119.374,145.166z" p-id="1337">,</path>,<rect x="115.894" y="143.119" fill="#FFFFFF" width="1.315" height="0.527" p-id="1338"></rect><rect x="117.613" y="143.118" fill="#FFFFFF" width="1.315" height="0.527" p-id="1339"></rect><rect x="115.895" y="144.042" fill="#FFFFFF" width="3.034" height="0.813" p-id="1340"></rect><g p-id="1341">,<path fill="#D8D8D8" d="M111.976,131.974c-0.82-0.543,0.176-2.081,1.023-2.932s1.519-1.188,2.189-1.014c0.469,0.122,1.102,1.168-0.015,2.077C113.919,131.126,113.369,132.898,111.976,131.974z" p-id="1342">,</path>,<circle fill="#D8D8D8" cx="111.865" cy="133.908" r="0.962" p-id="1343"></circle></g>,<path fill="#D8D8D8" d="M112.247,85.099c0,1.057-0.857,1.913-1.913,1.913H59.158c-1.057,0-1.913-0.857-1.913-1.913l0,0c0-1.057,0.857-1.913,1.913-1.913h51.175C111.39,83.186,112.247,84.042,112.247,85.099L112.247,85.099z" p-id="1344"></path><path fill="#D8D8D8" d="M83.201,98.717c0,1.057-0.857,1.913-1.913,1.913H59.158c-1.057,0-1.913-0.857-1.913-1.913l0,0c0-1.057,0.857-1.913,1.913-1.913h22.129C82.344,96.804,83.201,97.66,83.201,98.717L83.201,98.717z" p-id="1345"></path><path fill="#D8D8D8" d="M83.201,112.335c0,1.057-0.857,1.913-1.913,1.913H59.158c-1.057,0-1.913-0.857-1.913-1.913l0,0c0-1.057,0.857-1.913,1.913-1.913h22.129C82.344,110.422,83.201,111.278,83.201,112.335L83.201,112.335z" p-id="1346"></path><path fill="#D8D8D8" d="M141.451,148.653c-0.669-0.798-1.858-0.902-2.656-0.234l-0.003,0.003l-2.983-3.559c3.835-4.361,6.162-10.08,6.162-16.344c0-13.675-11.086-24.76-24.76-24.76c-13.675,0-24.76,11.086-24.76,24.76c0,13.675,11.086,24.76,24.76,24.76c5.177,0,9.983-1.59,13.957-4.307l2.876,3.43l-0.003,0.003c-0.798,0.669-0.902,1.858-0.234,2.656l9.153,10.918c2.63-2.047,5.132-4.249,7.475-6.612L141.451,148.653z M117.149,146.768c-10.078,0-18.247-8.17-18.247-18.248c0-10.078,8.17-18.247,18.247-18.247c10.078,0,18.248,8.17,18.248,18.247C135.397,138.598,127.227,146.768,117.149,146.768z" p-id="1347"></path>,</svg>,<div class="message" p-id="1348">没有运行轨迹～～</div></div>


<script src="incoming/1.0.0_gx_wlw/incoming/jquery-3.3.1.min.js"></script>
<script type="text/javascript"
        src="https://webapi.amap.com/maps?v=1.4.15&key=7f86f00d650beb404e5be8551ea2221e"></script>
<script type="text/javascript">    //地图初始化时，在地图上添加一个marker标记,鼠标点击marker可弹出自定义的信息窗体

var urlParm = window.location.href.split("?")[1];
var dataGroup = {};
if(urlParm.indexOf("&")!=-1){
	var keyGroup = urlParm.split("&");
	keyGroup.forEach(value => { 
		var keyGroup=value.split("=")
        dataGroup[keyGroup[0]] = keyGroup[1]
    })
}else{
	dataGroup["iccid"] = urlParm.split("=")[1]
}

function coord(){	
	$.ajax({
		type: 'POST',
		url: '/admin/TIccidCoordinate/queryEnttiybyCcid.action',
		data: JSON.stringify(dataGroup),
		beforeSend: function(request) {
			request.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
		},
		dataType: 'json',
		success: function(data) {
			console.log(data.data.data)
			var dataJson = data.data.data
			
			if(data.result == "success"){
				var lineArr = [];
				if(dataJson.length!=0){
					for(var i=0;i<dataJson.length;i++){
						var arr=[];
						arr[0] = dataJson[i].latitude;
						arr[1] = dataJson[i].longitude;
						lineArr.push(arr)
					}
					$(".block-no-results").css({"display":"none"});
				}else{
					$(".block-no-results").css({"display":"block"});
					return;
				}
				console.log(lineArr[0])
				console.log(lineArr[0],lineArr[0])
				var map = new AMap.Map("container", {
				    resizeEnable: true,
				    center: lineArr[0],
				    zoom: 14
				});
//				开始点标记
			    var startMarker = new AMap.Marker({
			        position: new AMap.LngLat(lineArr[0][0],lineArr[0][1]),
			        // 将一张图片的地址设置为 icon
			        icon: new AMap.Icon({
				        // 图标尺寸
				        size: new AMap.Size(25, 34),
				        // 图标的取图地址
				        image: '//a.amap.com/jsapi_demos/static/demo-center/icons/dir-marker.png',
				        // 图标所用图片大小
				        imageSize: new AMap.Size(135, 40),
				        // 图标取图偏移量
				        imageOffset: new AMap.Pixel(-9, -3)
				    }),
			        // 设置了 icon 以后，设置 icon 的偏移量，以 icon 的 [center bottom] 为原点
			        offset: new AMap.Pixel(-13, -30)
			    });

//				结束点标记
			    var endMarker = new AMap.Marker({
			        position: new AMap.LngLat(lineArr[lineArr.length-1][0],lineArr[lineArr.length-1][1]),
			        icon: new AMap.Icon({
				        size: new AMap.Size(25, 34),
				        image: '//a.amap.com/jsapi_demos/static/demo-center/icons/dir-marker.png',
				        imageSize: new AMap.Size(135, 40),
				        imageOffset: new AMap.Pixel(-95, -3)
				    }),
			        offset: new AMap.Pixel(-13, -30)
			    });
			    
				startMarker.setMap(map);
				endMarker.setMap(map);
				
//				var markerSpan = document.createElement("span");
//			        markerSpan.className = 'marker';
//			        markerSpan.innerHTML = "Hi，我被更新啦！";
//			        markerContent.appendChild(markerSpan);
//			
//			        marker.setContent(markerContent); //更新点标记内容
//			        marker.setPosition(lineArr[0]); //更新点标记位置
				
				
				
			    var polyline = new AMap.Polyline({
			        path: lineArr,          //设置线覆盖物路径
			        strokeColor: "#3366FF", //线颜色
			        strokeWeight: 5,        //线宽
			        strokeStyle: "solid",   //线样式
			    });
			    
			    
			    
			    map.add(polyline);
			}

		},
		error: function(xhr, type) {
			alert("错误")
		}
	});
}
coord()





</script>
</body>
</html>